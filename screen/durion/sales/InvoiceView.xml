<?xml version="1.0" encoding="UTF-8"?>
<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"
        default-menu-title="Invoices" default-menu-index="4">

    <transition name="syncToAccounting">
        <service-call name="durion.sales.DurSaleAccountingServices.sync#InvoiceToAccounting"/>
        <default-response url="."/>
    </transition>

    <actions>
        <entity-find entity-name="durion.sales.DurSaleInvoice" list="invoiceList">
            <search-form-inputs default-order-by="-invoiceDate"/>
        </entity-find>
    </actions>

    <widgets>
        <container>
            <label text="Invoices" type="h2"/>
            
            <container-box>
                <box-header title="Invoice List"/>
                <box-body>
                    <form-list name="InvoicesList" list="invoiceList">
                        <field name="invoiceNumber"><default-field><display/></default-field></field>
                        <field name="invoiceDate"><default-field><display format="yyyy-MM-dd"/></default-field></field>
                        <field name="customerName"><default-field><display/></default-field></field>
                        <field name="totalAmount"><default-field><display format="#,##0.00"/></default-field></field>
                        <field name="paidAmount"><default-field><display format="#,##0.00"/></default-field></field>
                        <field name="balanceDue"><default-field><display format="#,##0.00"/></default-field></field>
                        <field name="status"><default-field><display/></default-field></field>
                        <field name="accountingStatus"><default-field><display/></default-field></field>
                        <field name="syncButton"><default-field title="">
                            <link url="syncToAccounting" text="Sync to Accounting" 
                                  parameter-map="[invoiceId: invoiceId]"
                                  condition="accountingStatus != 'synced'"/>
                        </default-field></field>
                    </form-list>
                </box-body>
            </container-box>
        </container>
    </widgets>

</screen>
